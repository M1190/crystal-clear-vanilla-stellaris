create_exofungus_primitive_empire = {
	create_country = {
		name = random
		authority = random
		civics = {
			civic = civic_landed_nobility
			civic = civic_flat_world_theory
		}
		species = event_target:exofungus_species
		ethos = random
		flag = {
			icon = {
				category = "special"
				file = "primitive.dds"
			}
			background = {
				category = "backgrounds"
				file = "new_dawn.dds"
			}
			colors = {
				"turquoise"
				"green"
				"null"
				"null"
			}
		}
		origin = "origin_enlightened"		# Should only be visible if they become spacefaring
		type = primitive
		effect = {
			set_graphical_culture = preindustrial_01
			random_list = {
				2 = {
					set_country_flag = stone_age
					set_primitive_age = stone_age
					change_government = {
						authority = random
						civics = {
							civic = civic_secret_of_fire
							civic = civic_the_wheel
						}
					}
				}
				1 = {
					set_country_flag = bronze_age
					set_primitive_age = bronze_age
					change_government = {
						authority = random
						civics = {
							civic = civic_secret_of_fire
							civic = civic_the_wheel
						}
					}
					change_country_flag = {
						icon = {
							category = "special"
							file = "primitive.dds"
						}
						background = {
							category = "backgrounds"
							file = "new_dawn.dds"
						}
						colors = {
							"green"
							"dark_green"
							"null"
							"null"
						}
					}
				}
				1 = {
					set_country_flag = iron_age
					set_primitive_age = iron_age
					change_country_flag = {
						icon = {
							category = "special"
							file = "primitive.dds"
						}
						background = {
							category = "backgrounds"
							file = "new_dawn.dds"
						}
						colors = {
							"purple"
							"dark_purple"
							"null"
							"null"
						}
					}
				}
				1 = {
					set_country_flag = late_medieval_age
					set_primitive_age = late_medieval_age
					change_country_flag = {
						icon = {
							category = "special"
							file = "primitive.dds"
						}
						background = {
							category = "backgrounds"
							file = "new_dawn.dds"
						}
						colors = {
							"light_blue"
							"blue"
							"null"
							"null"
						}
					}
				}
			}
		}
	}
}

setup_exofungus_primitive_planet = {
	set_owner = last_created_country
	set_capital = yes
	last_created_country = {
		switch = {
			trigger = has_country_flag
			stone_age = {
				prev = {
					while = {
						count = 4
						create_pop = {
							species = event_target:exofungus_species
						}
					}
					add_building = building_crude_huts
					remove_building = building_colony_shelter
				}
			}
			bronze_age = {
				prev = {
					while = {
						count = 8
						create_pop = {
							species = event_target:exofungus_species
						}
					}
					add_building = building_primitive_dwellings
					add_building = building_stone_palace
					remove_building = building_colony_shelter
				}
			}
			iron_age = {
				prev = {
					while = {
						count = 9
						create_pop = {
							species = event_target:exofungus_species
						}
					}
					add_building = building_primitive_dwellings
					add_building = building_stone_palace
					remove_building = building_colony_shelter
				}
			}
			late_medieval_age = {
				prev = {
					while = {
						count = 10
						create_pop = {
							species = event_target:exofungus_species
						}
					}
					add_building = building_primitive_dwellings
					add_building = building_primitive_dwellings
					add_building = building_stone_palace
					remove_building = building_colony_shelter
				}
			}
		}
	}
}

exofungus_notification_effect = {
	if = {
		# We have pops of this species
		limit = {
			space_owner = {
				any_owned_species = {
					is_same_species = event_target:spore_species
				}
			}
		}
		if = {
			limit = {
				is_under_colonization = no
			}
			create_message = {
				type = MESSAGE_TYPE_EXOFUNGUS
				localization = EXOFUNGUS_NORMAL_DESC
				days = 20
				target = event_target:spore_planet
				variable = {
					type = name
					localization = SPECIES
					scope = event_target:spore_species
				}
			}
		}
		else_if = {
			limit = {
				is_under_colonization = yes
			}
			create_message = {
				type = MESSAGE_TYPE_EXOFUNGUS
				localization = EXOFUNGUS_PREEXISTING_DESC
				days = 20
				target = event_target:spore_planet
				variable = {
					type = name
					localization = SPECIES
					scope = event_target:spore_species
				}
			}
		}
	}
	else_if = {
		# We know an empire that has pops of this species, and have other Exofungi
		limit = {
			space_owner = {
				any_owned_species = {
					has_trait = trait_exofungus
				}
				NOT = {
					any_owned_species = {
						is_same_species = event_target:spore_species
					}
				}
			}
			any_country = {
				any_owned_species = {
					is_same_species = event_target:spore_species
				}
				has_communications = event_target:spore_host
			}
		}
		space_owner = {
			country_event = {
				id = eo_exofungus.5
			}
		}
	}
	else_if = {
		# We know an empire that has pops of this species, but these are the first Exofungi in our empire
		limit = {
			any_country = {
				any_owned_species = {
					is_same_species = event_target:spore_species
				}
				has_communications = event_target:spore_host
			}
		}
		space_owner = {
			country_event = {
				id = eo_exofungus.6
			}
		}
	}
	else_if = {
		# We have other Exofungi, but this is the first time seeing this species
		limit = {
			space_owner = {
				any_owned_species = {
					has_trait = trait_exofungus
				}
				NOR = {
					any_owned_species = {
						is_same_species = event_target:spore_species
					}
					any_country = {
						any_owned_species = {
							is_same_species = event_target:spore_species
						}
						has_communications = event_target:spore_host
					}
				}
			}
		}
		space_owner = {
			country_event = {
				id = eo_exofungus.7
			}
		}
	}
	else = {
		# I have never seen this man before in my life
		space_owner = {
			country_event = {
				id = eo_exofungus.8
			}
		}
	}
}

primitive_exofungus_notification = {
	if = {
		# We have this species, or know of them and have our own exofungi
		limit = {
			any_owned_species = {
				has_trait = trait_exofungus
			}
			any_country = {
				NOT = {
					is_same_value = event_target:exofungus_primtive
				}
				any_owned_species = {
					is_same_species = event_target:spore_species
				}
				has_communications = event_target:spore_host
			}
		}
		space_owner = {
			country_event = {
				id = eo_exofungus.13
			}
		}
	}
	else_if = {
		# We know an empire that has pops of this species, but these are the first Exofungi in our empire
		limit = {
			any_country = {
				NOT = {
					is_same_value = event_target:exofungus_primtive
				}
				any_owned_species = {
					is_same_species = event_target:spore_species
				}
				has_communications = event_target:spore_host
			}
		}
		space_owner = {
			country_event = {
				id = eo_exofungus.14
			}
		}
	}
	else_if = {
		# We have other Exofungi, but this is the first time seeing this species
		limit = {
			any_owned_species = {
				has_trait = trait_exofungus
			}
			NOR = {
				any_owned_species = {
					is_same_species = event_target:spore_species
				}
				any_country = {
					NOT = {
						is_same_value = event_target:exofungus_primtive
					}
					any_owned_species = {
						is_same_species = event_target:spore_species
					}
					has_communications = event_target:spore_host
				}
			}
		}
		space_owner = {
			country_event = {
				id = eo_exofungus.15
			}
		}
	}
	else = {
		# I have never seen this man before in my life
		space_owner = {
			country_event = {
				id = eo_exofungus.16
			}
		}
	}
}

wild_space_sprouts_notification = {
	if = {
		limit = {
			any_owned_species = {
				is_same_species = event_target:spore_species
			}
		}
		create_message = {
			type = MESSAGE_TYPE_EXOFUNGUS
			localization = EXOFUNGUS_OUTSIDE_BORDERS_DESC
			days = 20
			target = event_target:spore_planet
			variable = {
				type = name
				localization = SPECIES
				scope = event_target:spore_species
			}
		}
	}
	else_if = {
		# We know an empire that has pops of this species, and have other Exofungi
		limit = {
			event_target:spore_host = {
				any_owned_species = {
					has_trait = trait_exofungus
				}
				NOT = {
					any_owned_species = {
						is_same_species = event_target:spore_species
					}
				}
			}
			any_country = {
				NOT = {
					is_same_value = event_target:exofungus_primtive
				}
				any_owned_species = {
					is_same_species = event_target:spore_species
				}
				has_communications = event_target:spore_host
			}
		}
		country_event = {
			id = eo_exofungus.9
		}
	}
	else_if = {
		# We know an empire that has pops of this species, but these are the first Exofungi in our empire
		limit = {
			any_country = {
				NOT = {
					is_same_value = event_target:exofungus_primtive
				}
				any_owned_species = {
					is_same_species = event_target:spore_species
				}
				has_communications = event_target:spore_host
			}
		}
		country_event = {
			id = eo_exofungus.10
		}
	}
	else_if = {
		# We have other Exofungi, but this is the first time seeing this species
		limit = {
			any_owned_species = {
				has_trait = trait_exofungus
				NOT = {
					is_same_species = event_target:spore_species
				}
			}
			NOT = {
				any_country = {
					NOT = {
						is_same_value = event_target:exofungus_primtive
					}
					any_owned_species = {
						is_same_species = event_target:spore_species
					}
					has_communications = event_target:spore_host
				}
			}
		}
		country_event = {
			id = eo_exofungus.11
		}
	}
	else = {
		# I have never seen this man before in my life
		country_event = {
			id = eo_exofungus.12
		}
	}
}
